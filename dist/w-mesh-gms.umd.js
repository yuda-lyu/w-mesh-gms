/*!
 * w-mesh-gms v1.0.7
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("fs")):"function"==typeof define&&define.amd?define(["fs"],r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-mesh-gms"]=r(t.fs)}(this,(function(t){"use strict";var r=Array.isArray,e="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,o=e||n||Function("return this")(),u=o.Symbol,i=Object.prototype,c=i.hasOwnProperty,a=i.toString,f=u?u.toStringTag:void 0;var l=Object.prototype.toString;var s="[object Null]",p="[object Undefined]",v=u?u.toStringTag:void 0;function h(t){return null==t?void 0===t?p:s:v&&v in Object(t)?function(t){var r=c.call(t,f),e=t[f];try{t[f]=void 0;var n=!0}catch(t){}var o=a.call(t);return n&&(r?t[f]=e:delete t[f]),o}(t):function(t){return l.call(t)}(t)}function d(t){return null!=t&&"object"==typeof t}var y="[object Symbol]";function b(t){return"symbol"==typeof t||d(t)&&h(t)==y}var j=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/;function _(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!b(t))||(g.test(t)||!j.test(t)||null!=e&&t in Object(e))}function $(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}var m="[object AsyncFunction]",w="[object Function]",O="[object GeneratorFunction]",S="[object Proxy]";function z(t){if(!$(t))return!1;var r=h(t);return r==w||r==O||r==m||r==S}var A,x=o["__core-js_shared__"],E=(A=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"";var k=Function.prototype.toString;function I(t){if(null!=t){try{return k.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var P=/^\[object .+?Constructor\]$/,D=Function.prototype,F=Object.prototype,T=D.toString,U=F.hasOwnProperty,M=RegExp("^"+T.call(U).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function N(t){return!(!$(t)||(r=t,E&&E in r))&&(z(t)?M:P).test(I(t));var r}function R(t,r){var e=function(t,r){return null==t?void 0:t[r]}(t,r);return N(e)?e:void 0}var H=R(Object,"create");var B=Object.prototype.hasOwnProperty;var G=Object.prototype.hasOwnProperty;function L(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function C(t,r){return t===r||t!=t&&r!=r}function V(t,r){for(var e=t.length;e--;)if(C(t[e][0],r))return e;return-1}L.prototype.clear=function(){this.__data__=H?H(null):{},this.size=0},L.prototype.delete=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},L.prototype.get=function(t){var r=this.__data__;if(H){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return B.call(r,t)?r[t]:void 0},L.prototype.has=function(t){var r=this.__data__;return H?void 0!==r[t]:G.call(r,t)},L.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=H&&void 0===r?"__lodash_hash_undefined__":r,this};var X=Array.prototype.splice;function Y(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Y.prototype.clear=function(){this.__data__=[],this.size=0},Y.prototype.delete=function(t){var r=this.__data__,e=V(r,t);return!(e<0)&&(e==r.length-1?r.pop():X.call(r,e,1),--this.size,!0)},Y.prototype.get=function(t){var r=this.__data__,e=V(r,t);return e<0?void 0:r[e][1]},Y.prototype.has=function(t){return V(this.__data__,t)>-1},Y.prototype.set=function(t,r){var e=this.__data__,n=V(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};var q=R(o,"Map");function W(t,r){var e,n,o=t.__data__;return("string"==(n=typeof(e=r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof r?"string":"hash"]:o.map}function Z(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new L,map:new(q||Y),string:new L}},Z.prototype.delete=function(t){var r=W(this,t).delete(t);return this.size-=r?1:0,r},Z.prototype.get=function(t){return W(this,t).get(t)},Z.prototype.has=function(t){return W(this,t).has(t)},Z.prototype.set=function(t,r){var e=W(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};var J="Expected a function";function K(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError(J);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],u=e.cache;if(u.has(o))return u.get(o);var i=t.apply(this,n);return e.cache=u.set(o,i)||u,i};return e.cache=new(K.Cache||Z),e}K.Cache=Z;var Q,tt,rt,et=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nt=/\\(\\)?/g,ot=(Q=function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(et,(function(t,e,n,o){r.push(n?o.replace(nt,"$1"):e||t)})),r},tt=K(Q,(function(t){return 500===rt.size&&rt.clear(),t})),rt=tt.cache,tt),ut=ot;function it(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}var ct=1/0,at=u?u.prototype:void 0,ft=at?at.toString:void 0;function lt(t){if("string"==typeof t)return t;if(r(t))return it(t,lt)+"";if(b(t))return ft?ft.call(t):"";var e=t+"";return"0"==e&&1/t==-ct?"-0":e}function st(t){return null==t?"":lt(t)}function pt(t,e){return r(t)?t:_(t,e)?[t]:ut(st(t))}var vt=1/0;function ht(t){if("string"==typeof t||b(t))return t;var r=t+"";return"0"==r&&1/t==-vt?"-0":r}function dt(t,r){for(var e=0,n=(r=pt(r,t)).length;null!=t&&e<n;)t=t[ht(r[e++])];return e&&e==n?t:void 0}function yt(t,r,e){var n=null==t?void 0:dt(t,r);return void 0===n?e:n}function bt(t){var r=this.__data__=new Y(t);this.size=r.size}bt.prototype.clear=function(){this.__data__=new Y,this.size=0},bt.prototype.delete=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e},bt.prototype.get=function(t){return this.__data__.get(t)},bt.prototype.has=function(t){return this.__data__.has(t)},bt.prototype.set=function(t,r){var e=this.__data__;if(e instanceof Y){var n=e.__data__;if(!q||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new Z(n)}return e.set(t,r),this.size=e.size,this};function jt(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new Z;++r<e;)this.add(t[r])}function gt(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function _t(t,r){return t.has(r)}jt.prototype.add=jt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},jt.prototype.has=function(t){return this.__data__.has(t)};var $t=1,mt=2;function wt(t,r,e,n,o,u){var i=e&$t,c=t.length,a=r.length;if(c!=a&&!(i&&a>c))return!1;var f=u.get(t),l=u.get(r);if(f&&l)return f==r&&l==t;var s=-1,p=!0,v=e&mt?new jt:void 0;for(u.set(t,r),u.set(r,t);++s<c;){var h=t[s],d=r[s];if(n)var y=i?n(d,h,s,r,t,u):n(h,d,s,t,r,u);if(void 0!==y){if(y)continue;p=!1;break}if(v){if(!gt(r,(function(t,r){if(!_t(v,r)&&(h===t||o(h,t,e,n,u)))return v.push(r)}))){p=!1;break}}else if(h!==d&&!o(h,d,e,n,u)){p=!1;break}}return u.delete(t),u.delete(r),p}var Ot=o.Uint8Array;function St(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e}function zt(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e}var At=1,xt=2,Et="[object Boolean]",kt="[object Date]",It="[object Error]",Pt="[object Map]",Dt="[object Number]",Ft="[object RegExp]",Tt="[object Set]",Ut="[object String]",Mt="[object Symbol]",Nt="[object ArrayBuffer]",Rt="[object DataView]",Ht=u?u.prototype:void 0,Bt=Ht?Ht.valueOf:void 0;var Gt=Object.prototype.propertyIsEnumerable,Lt=Object.getOwnPropertySymbols,Ct=Lt?function(t){return null==t?[]:(t=Object(t),function(t,r){for(var e=-1,n=null==t?0:t.length,o=0,u=[];++e<n;){var i=t[e];r(i,e,t)&&(u[o++]=i)}return u}(Lt(t),(function(r){return Gt.call(t,r)})))}:function(){return[]},Vt=Ct;function Xt(t){return d(t)&&"[object Arguments]"==h(t)}var Yt=Object.prototype,qt=Yt.hasOwnProperty,Wt=Yt.propertyIsEnumerable,Zt=Xt(function(){return arguments}())?Xt:function(t){return d(t)&&qt.call(t,"callee")&&!Wt.call(t,"callee")},Jt=Zt;var Kt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Qt=Kt&&"object"==typeof module&&module&&!module.nodeType&&module,tr=Qt&&Qt.exports===Kt?o.Buffer:void 0,rr=(tr?tr.isBuffer:void 0)||function(){return!1},er=9007199254740991,nr=/^(?:0|[1-9]\d*)$/;function or(t,r){var e=typeof t;return!!(r=null==r?er:r)&&("number"==e||"symbol"!=e&&nr.test(t))&&t>-1&&t%1==0&&t<r}var ur=9007199254740991;function ir(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ur}var cr={};function ar(t){return function(r){return t(r)}}cr["[object Float32Array]"]=cr["[object Float64Array]"]=cr["[object Int8Array]"]=cr["[object Int16Array]"]=cr["[object Int32Array]"]=cr["[object Uint8Array]"]=cr["[object Uint8ClampedArray]"]=cr["[object Uint16Array]"]=cr["[object Uint32Array]"]=!0,cr["[object Arguments]"]=cr["[object Array]"]=cr["[object ArrayBuffer]"]=cr["[object Boolean]"]=cr["[object DataView]"]=cr["[object Date]"]=cr["[object Error]"]=cr["[object Function]"]=cr["[object Map]"]=cr["[object Number]"]=cr["[object Object]"]=cr["[object RegExp]"]=cr["[object Set]"]=cr["[object String]"]=cr["[object WeakMap]"]=!1;var fr="object"==typeof exports&&exports&&!exports.nodeType&&exports,lr=fr&&"object"==typeof module&&module&&!module.nodeType&&module,sr=lr&&lr.exports===fr&&e.process,pr=function(){try{var t=lr&&lr.require&&lr.require("util").types;return t||sr&&sr.binding&&sr.binding("util")}catch(t){}}(),vr=pr&&pr.isTypedArray,hr=vr?ar(vr):function(t){return d(t)&&ir(t.length)&&!!cr[h(t)]},dr=Object.prototype.hasOwnProperty;function yr(t,e){var n=r(t),o=!n&&Jt(t),u=!n&&!o&&rr(t),i=!n&&!o&&!u&&hr(t),c=n||o||u||i,a=c?function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}(t.length,String):[],f=a.length;for(var l in t)!e&&!dr.call(t,l)||c&&("length"==l||u&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||or(l,f))||a.push(l);return a}var br=Object.prototype;var jr=function(t,r){return function(e){return t(r(e))}}(Object.keys,Object),gr=jr,_r=Object.prototype.hasOwnProperty;function $r(t){if(e=(r=t)&&r.constructor,r!==("function"==typeof e&&e.prototype||br))return gr(t);var r,e,n=[];for(var o in Object(t))_r.call(t,o)&&"constructor"!=o&&n.push(o);return n}function mr(t){return null!=t&&ir(t.length)&&!z(t)}function wr(t){return mr(t)?yr(t):$r(t)}function Or(t){return function(t,e,n){var o=e(t);return r(t)?o:function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}(o,n(t))}(t,wr,Vt)}var Sr=1,zr=Object.prototype.hasOwnProperty;var Ar=R(o,"DataView"),xr=R(o,"Promise"),Er=R(o,"Set"),kr=R(o,"WeakMap"),Ir="[object Map]",Pr="[object Promise]",Dr="[object Set]",Fr="[object WeakMap]",Tr="[object DataView]",Ur=I(Ar),Mr=I(q),Nr=I(xr),Rr=I(Er),Hr=I(kr),Br=h;(Ar&&Br(new Ar(new ArrayBuffer(1)))!=Tr||q&&Br(new q)!=Ir||xr&&Br(xr.resolve())!=Pr||Er&&Br(new Er)!=Dr||kr&&Br(new kr)!=Fr)&&(Br=function(t){var r=h(t),e="[object Object]"==r?t.constructor:void 0,n=e?I(e):"";if(n)switch(n){case Ur:return Tr;case Mr:return Ir;case Nr:return Pr;case Rr:return Dr;case Hr:return Fr}return r});var Gr=Br,Lr=1,Cr="[object Arguments]",Vr="[object Array]",Xr="[object Object]",Yr=Object.prototype.hasOwnProperty;function qr(t,e,n,o,u,i){var c=r(t),a=r(e),f=c?Vr:Gr(t),l=a?Vr:Gr(e),s=(f=f==Cr?Xr:f)==Xr,p=(l=l==Cr?Xr:l)==Xr,v=f==l;if(v&&rr(t)){if(!rr(e))return!1;c=!0,s=!1}if(v&&!s)return i||(i=new bt),c||hr(t)?wt(t,e,n,o,u,i):function(t,r,e,n,o,u,i){switch(e){case Rt:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case Nt:return!(t.byteLength!=r.byteLength||!u(new Ot(t),new Ot(r)));case Et:case kt:case Dt:return C(+t,+r);case It:return t.name==r.name&&t.message==r.message;case Ft:case Ut:return t==r+"";case Pt:var c=St;case Tt:var a=n&At;if(c||(c=zt),t.size!=r.size&&!a)return!1;var f=i.get(t);if(f)return f==r;n|=xt,i.set(t,r);var l=wt(c(t),c(r),n,o,u,i);return i.delete(t),l;case Mt:if(Bt)return Bt.call(t)==Bt.call(r)}return!1}(t,e,f,n,o,u,i);if(!(n&Lr)){var h=s&&Yr.call(t,"__wrapped__"),d=p&&Yr.call(e,"__wrapped__");if(h||d){var y=h?t.value():t,b=d?e.value():e;return i||(i=new bt),u(y,b,n,o,i)}}return!!v&&(i||(i=new bt),function(t,r,e,n,o,u){var i=e&Sr,c=Or(t),a=c.length;if(a!=Or(r).length&&!i)return!1;for(var f=a;f--;){var l=c[f];if(!(i?l in r:zr.call(r,l)))return!1}var s=u.get(t),p=u.get(r);if(s&&p)return s==r&&p==t;var v=!0;u.set(t,r),u.set(r,t);for(var h=i;++f<a;){var d=t[l=c[f]],y=r[l];if(n)var b=i?n(y,d,l,r,t,u):n(d,y,l,t,r,u);if(!(void 0===b?d===y||o(d,y,e,n,u):b)){v=!1;break}h||(h="constructor"==l)}if(v&&!h){var j=t.constructor,g=r.constructor;j==g||!("constructor"in t)||!("constructor"in r)||"function"==typeof j&&j instanceof j&&"function"==typeof g&&g instanceof g||(v=!1)}return u.delete(t),u.delete(r),v}(t,e,n,o,u,i))}function Wr(t,r,e,n,o){return t===r||(null==t||null==r||!d(t)&&!d(r)?t!=t&&r!=r:qr(t,r,e,n,Wr,o))}var Zr=1,Jr=2;function Kr(t){return t==t&&!$(t)}function Qr(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}}function te(t){var r=function(t){for(var r=wr(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,Kr(o)]}return r}(t);return 1==r.length&&r[0][2]?Qr(r[0][0],r[0][1]):function(e){return e===t||function(t,r,e,n){var o=e.length,u=o,i=!n;if(null==t)return!u;for(t=Object(t);o--;){var c=e[o];if(i&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<u;){var a=(c=e[o])[0],f=t[a],l=c[1];if(i&&c[2]){if(void 0===f&&!(a in t))return!1}else{var s=new bt;if(n)var p=n(f,l,a,t,r,s);if(!(void 0===p?Wr(l,f,Zr|Jr,n,s):p))return!1}}return!0}(e,t,r)}}function re(t,r){return null!=t&&r in Object(t)}function ee(t,e){return null!=t&&function(t,e,n){for(var o=-1,u=(e=pt(e,t)).length,i=!1;++o<u;){var c=ht(e[o]);if(!(i=null!=t&&n(t,c)))break;t=t[c]}return i||++o!=u?i:!!(u=null==t?0:t.length)&&ir(u)&&or(c,u)&&(r(t)||Jt(t))}(t,e,re)}var ne=1,oe=2;function ue(t){return t}function ie(t){return function(r){return null==r?void 0:r[t]}}function ce(t){return _(t)?ie(ht(t)):function(t){return function(r){return dt(r,t)}}(t)}function ae(t){return"function"==typeof t?t:null==t?ue:"object"==typeof t?r(t)?(e=t[0],n=t[1],_(e)&&Kr(n)?Qr(ht(e),n):function(t){var r=yt(t,e);return void 0===r&&r===n?ee(t,e):Wr(n,r,ne|oe)}):te(t):ce(t);var e,n}var fe,le=function(t,r,e){for(var n=-1,o=Object(t),u=e(t),i=u.length;i--;){var c=u[fe?i:++n];if(!1===r(o[c],c,o))break}return t};var se=function(t,r){return function(e,n){if(null==e)return e;if(!mr(e))return t(e,n);for(var o=e.length,u=r?o:-1,i=Object(e);(r?u--:++u<o)&&!1!==n(i[u],u,i););return e}}((function(t,r){return t&&le(t,r,wr)})),pe=se;function ve(t,r){var e=-1,n=mr(t)?Array(t.length):[];return pe(t,(function(t,o,u){n[++e]=r(t,o,u)})),n}function he(t,e){return(r(t)?it:ve)(t,ae(e))}function de(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t}function ye(t,e){var n;return(r(t)?de:pe)(t,"function"==typeof(n=e)?n:ue)}var be="[object String]";var je=ie("length"),ge=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function _e(t){return ge.test(t)}var $e="\\ud800-\\udfff",me="["+$e+"]",we="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Oe="\\ud83c[\\udffb-\\udfff]",Se="[^"+$e+"]",ze="(?:\\ud83c[\\udde6-\\uddff]){2}",Ae="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="(?:"+we+"|"+Oe+")"+"?",Ee="[\\ufe0e\\ufe0f]?",ke=Ee+xe+("(?:\\u200d(?:"+[Se,ze,Ae].join("|")+")"+Ee+xe+")*"),Ie="(?:"+[Se+we+"?",we,ze,Ae,me].join("|")+")",Pe=RegExp(Oe+"(?="+Oe+")|"+Ie+ke,"g");function De(t){return _e(t)?function(t){for(var r=Pe.lastIndex=0;Pe.test(t);)++r;return r}(t):je(t)}var Fe="[object Map]",Te="[object Set]";function Ue(t){if(null==t)return 0;if(mr(t))return"string"==typeof(e=t)||!r(e)&&d(e)&&h(e)==be?De(t):t.length;var e,n=Gr(t);return n==Fe||n==Te?t.size:$r(t).length}var Me=Array.prototype.join;function Ne(t,r,e){var n=-1,o=t.length;r<0&&(r=-r>o?0:o+r),(e=e>o?o:e)<0&&(e+=o),o=r>e?0:e-r>>>0,r>>>=0;for(var u=Array(o);++n<o;)u[n]=t[n+r];return u}var Re=/\s/;var He=/^\s+/;function Be(t){return t?t.slice(0,function(t){for(var r=t.length;r--&&Re.test(t.charAt(r)););return r}(t)+1).replace(He,""):t}var Ge=NaN,Le=/^[-+]0x[0-9a-f]+$/i,Ce=/^0b[01]+$/i,Ve=/^0o[0-7]+$/i,Xe=parseInt;function Ye(t){if("number"==typeof t)return t;if(b(t))return Ge;if($(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=$(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=Be(t);var e=Ce.test(t);return e||Ve.test(t)?Xe(t.slice(2),e?2:8):Le.test(t)?Ge:+t}var qe=1/0,We=17976931348623157e292;function Ze(t){return t?(t=Ye(t))===qe||t===-qe?(t<0?-1:1)*We:t==t?t:0:0===t?t:0}function Je(t){var r=Ze(t),e=r%1;return r==r?e?r-e:r:0}function Ke(t,r,e){var n=null==t?0:t.length;return n?Ne(t,(r=e||void 0===r?1:Je(r))<0?0:r,n):[]}function Qe(t,r,e){var n=t.length;return e=void 0===e?n:e,!r&&e>=n?t:Ne(t,r,e)}var tn=pr&&pr.isRegExp,rn=tn?ar(tn):function(t){return d(t)&&"[object RegExp]"==h(t)};var en="\\ud800-\\udfff",nn="["+en+"]",on="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",un="\\ud83c[\\udffb-\\udfff]",cn="[^"+en+"]",an="(?:\\ud83c[\\udde6-\\uddff]){2}",fn="[\\ud800-\\udbff][\\udc00-\\udfff]",ln="(?:"+on+"|"+un+")"+"?",sn="[\\ufe0e\\ufe0f]?",pn=sn+ln+("(?:\\u200d(?:"+[cn,an,fn].join("|")+")"+sn+ln+")*"),vn="(?:"+[cn+on+"?",on,an,fn,nn].join("|")+")",hn=RegExp(un+"(?="+un+")|"+vn+pn,"g");function dn(t){return _e(t)?function(t){return t.match(hn)||[]}(t):function(t){return t.split("")}(t)}var yn=4294967295;function bn(t,r,e){return e&&"number"!=typeof e&&function(t,r,e){if(!$(e))return!1;var n=typeof r;return!!("number"==n?mr(e)&&or(r,e.length):"string"==n&&r in e)&&C(e[r],t)}(t,r,e)&&(r=e=void 0),(e=void 0===e?yn:e>>>0)?(t=st(t))&&("string"==typeof r||null!=r&&!rn(r))&&!(r=lt(r))&&_e(t)?Qe(dn(t),0,e):t.split(r,e):[]}function jn(t){return null==t?[]:function(t,r){return it(r,(function(r){return t[r]}))}(t,wr(t))}function gn(t,r,e){for(var n=-1,o=t.length;++n<o;){var u=t[n],i=r(u);if(null!=i&&(void 0===c?i==i&&!b(i):e(i,c)))var c=i,a=u}return a}function _n(t,r){return t<r}function $n(t){return t&&t.length?gn(t,ue,_n):void 0}function mn(t,r){return t>r}function wn(t){return t&&t.length?gn(t,ue,mn):void 0}function On(t){return t!=t}function Sn(t,r,e){return r==r?function(t,r,e){for(var n=e-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1}(t,r,e):function(t,r,e,n){for(var o=t.length,u=e+(n?1:-1);n?u--:++u<o;)if(r(t[u],u,t))return u;return-1}(t,On,e)}function zn(t,r,e){if((t=st(t))&&(e||void 0===r))return Be(t);if(!t||!(r=lt(r)))return t;var n=dn(t),o=dn(r),u=function(t,r){for(var e=-1,n=t.length;++e<n&&Sn(r,t[e],0)>-1;);return e}(n,o),i=function(t,r){for(var e=t.length;e--&&Sn(r,t[e],0)>-1;);return e}(n,o)+1;return Qe(n,u,i).join("")}function An(t){return"[object String]"===Object.prototype.toString.call(t)}function xn(t){return!(!An(t)||""===t)}function En(t,r){if(!xn(t))return[];if(!xn(r))return[];let e=function(t,r){return xn(t)&&xn(r)?t.split(r):[]}(t,r);e=he(e,zn);let n=[];return ye(e,(function(t){xn(t)&&n.push(t)})),n}var kn=o.isFinite,In=Math.min;var Pn=function(t){var r=Math[t];return function(t,e){if(t=Ye(t),(e=null==e?0:In(Je(e),292))&&kn(t)){var n=(st(t)+"e").split("e");return+((n=(st(r(n[0]+"e"+(+n[1]+e)))+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}("round"),Dn=Pn;function Fn(t){return t!=t}function Tn(t){let r=!1;if(xn(t))r=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Fn(t))return!1;r=!0}return r}function Un(t){if(!Tn(t))return 0;return Ze(t)}function Mn(t){if(!Tn(t))return 0;t=Un(t);let r=Dn(t);return"0"===String(r)?0:r}function Nn(t){if(!xn(t)&&!Tn(t)&&!b(t))return"";let r="";try{r=String(t)}catch(t){}try{r=t.toString()}catch(t){}return r}function Rn(t){return"[object Object]"===Object.prototype.toString.call(t)}function Hn(t){if(Rn(t)){for(let r in t)return!0;return!1}return!1}function Bn(t){return"[object Array]"===Object.prototype.toString.call(t)}function Gn(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Rn(t)){for(let r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!An(t)||""!==t)}(t)||(!!function(t){return!!Bn(t)&&0===t.length}(t)||!!Fn(t)))))}function Ln(t){return!!Bn(t)&&(0!==t.length&&(1!==t.length||!Gn(t[0])))}function Cn(t){let r=Object.prototype.toString.call(t);return"[object Function]"===r||"[object AsyncFunction]"===r}function Vn(t,r){let e=function(){let t,r,e=new Promise((function(){t=arguments[0],r=arguments[1]}));return e.resolve=t,e.reject=r,e}();if(!Bn(t)&&!Rn(t))return e.reject("rs is not an array or object"),e;let n=!1;if(Rn(t)){n=!0;let r=[];ye(t,((t,e)=>{r.push({k:e,v:t})})),t=r}Cn(r)||(r=function(t){return t});let o=-1,u=[];return t.reduce((function(t,e){return t.then((function(t){u.push(t),o+=1;let i=o,c=e;return n&&(i=e.k,c=e.v),Cn(r)?r(c,i):c}))}),Promise.resolve()).then((function(t){u.push(t),u=Ke(u),e.resolve(u)})).catch((function(t){e.reject(t)})),e}function Xn(r,e){let n=En(t.readFileSync(r,"utf8"),"\n");n=Ke(n,1);let o=he(n,(t=>bn(t,","))),u={};return ye(o,(t=>{let r=Mn(yt(t,1,0)),n=Mn(yt(t,2,0)),o=Mn(yt(t,3,0)),i=Mn(yt(t,4,0)),c=Un(yt(t,5,0)),a=Mn(yt(t,6,0));u[r]={id:r,i:o,j:i,k:n,[e]:c,active:a}})),u}async function Yn(t,r){let e=[];await Vn(t,(async(t,n)=>{let o=yt(t,"id",null);xn(o)||Tn(o)||(o=Nn(n)),o=Nn(o);let u=yt(t,"x",null);if(!Tn(u))throw new Error(`col.x[${u}] is not a number`);u=Un(u);let i=yt(t,"y",null);if(!Tn(i))throw new Error(`col.y[${i}] is not a number`);i=Un(i);let c=yt(t,"z",null);if(!Tn(c))throw new Error(`col.z[${c}] is not a number`);c=Un(c);let a=yt(t,"layers",[]);if(!Ln(a))throw new Error("col.layersis not an effective array");let f=[];await Vn(a,(async(t,r)=>{let e=yt(t,"mat",0),n=yt(t,"type",0),a=yt(t,"depthStart","");if(!Tn(a))throw new Error(`layers[${r}].depthStart[${a}] is not a number`);a=Un(a);let l=yt(t,"depthEnd","");if(!Tn(l))throw new Error(`layers[${r}].depthEnd[${l}] is not a number`);l=Un(l);let s=c-a;if(!Tn(s))throw new Error(`Z1[${s}] is not a number`);s=Un(s);let p=c-l;if(!Tn(p))throw new Error(`Z2[${p}] is not a number`);p=Un(p);let v=e,h=e,d=n;f.push({name:o,X:u,Y:i,depthStart:-s,depthEnd:-p,SoilID:v,HGUID:h,HorizonID:d})})),Cn(r)&&(f=r(f),function(t){let r,e=Object.prototype.toString.call(t);if(r="[object Promise]"===e,r)return!0;if("[object Function]"!==e)return!1;try{r="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return r}(f)&&(f=await f)),e.push(f)}));let n=[];var o,u;return ye(e,(t=>{ye(t,((r,e)=>{let o="";o=`${r.name},${r.X},${r.Y},${-r.depthStart},${r.SoilID},${r.HGUID},${r.HorizonID}\n`,n.push(o),e===Ue(t)-1&&(o=`${r.name},${r.X},${r.Y},${-r.depthEnd},${r.SoilID},${r.HGUID},${r.HorizonID}\n`,n.push(o))}))})),u="",null==(o=n)?"":Me.call(o,u)}let qn={readGms:async function(r,e,n,o){let u=function(r){let e=En(t.readFileSync(r,"utf8"),"\n");e=Ke(e,1);let n=yt(he(e,(t=>bn(t,","))),0,[]);return{blx:Un(yt(n,0,0)),bly:Un(yt(n,1,0)),z:Un(yt(n,2,0)),sx:Un(yt(n,3,0)),sy:Un(yt(n,4,0)),sz:Un(yt(n,5,0))}}(r),i=Xn(e,"top"),c=Xn(n,"bot"),a=function(r){let e=En(t.readFileSync(r,"utf8"),"\n");e=Ke(e,1);let n=he(e,(t=>bn(t,","))),o={};return ye(n,(t=>{let r=Mn(yt(t,1,0)),e=Mn(yt(t,2,0)),n=Mn(yt(t,3,0)),u=Mn(yt(t,4,0)),i=Mn(yt(t,5,0));o[r]={id:r,i:n,j:u,k:e,mat:i}})),o}(o),f={};ye(a,((t,r)=>{let e=yt(i,`${r}.top`,0),n=yt(c,`${r}.bot`,0),o=yt(c,`${r}.active`,0),u=`${t.i}-${t.j}-${t.k}`;f[u]={id:t.id,i:t.i,j:t.j,k:t.k,top:e,bot:n,mat:t.mat,active:o}}));let l=jn(f),s=he(l,"i"),p=$n(s),v=wn(s),h=he(l,"j"),d=$n(h),y=wn(h),b=he(l,"k"),j=$n(b),g=wn(b),_=[],$={};{let t=0;for(let r=g;r>=j;r--)for(let e=p;e<=v;e++)for(let n=d;n<=y;n++){let o=g-r+1,i=`${e}-${n}-${o}`,c=yt(f,`${e}-${n}-${r}`,{}),a=u.blx+(e+.5)*u.sx,l=u.bly+(n+.5)*u.sy,s=yt(c,"bot",0),p=yt(c,"mat",0),v=yt(c,"active",0);t++;let h={indn:t,key:i,x:a,y:l,z:s,mat:p,active:v};if(_.push(h),$[i]=h,r===j){i=`${e}-${n}-${o+1}`,s=yt(c,"top",0),t++;let r={indn:t,key:i,x:a,y:l,z:s,mat:p,active:v};_.push(r),$[i]=r}}}let m=[];{let t=0;for(let r=g;r>=j;r--)for(let e=p;e<=v-1;e++)for(let n=d;n<=y-1;n++){let o=g-r+1,u=`${e}-${n}-${o}`,i=`${e+1}-${n}-${o}`,c=`${e+1}-${n+1}-${o}`,a=`${e}-${n+1}-${o}`,f=`${e}-${n}-${o+1}`,l=`${e+1}-${n}-${o+1}`,s=`${e+1}-${n+1}-${o+1}`,p=`${e}-${n+1}-${o+1}`;if(8!==yt($,`${u}.active`,0)+yt($,`${i}.active`,0)+yt($,`${c}.active`,0)+yt($,`${a}.active`,0)+yt($,`${f}.active`,0)+yt($,`${l}.active`,0)+yt($,`${s}.active`,0)+yt($,`${p}.active`,0))continue;t++;let v={inde:t,nodes:[yt($,`${u}.indn`,0),yt($,`${i}.indn`,0),yt($,`${c}.indn`,0),yt($,`${a}.indn`,0),yt($,`${f}.indn`,0),yt($,`${l}.indn`,0),yt($,`${s}.indn`,0),yt($,`${p}.indn`,0)],mat:yt($,`${u}.mat`,0)};m.push(v)}}return{nodes:_,eles:m}},writeGms:async function(r,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Hn(r)&&!Ln(r))throw new Error("mnes is not an effective object or array");Hn(r)&&(r=[r]);let o=yt(n,"funProcLayers",null),u="name,X,Y,Z,SoilID,HGUID,HorizonID\n";return await Vn(r,(async t=>{let r=yt(t,"cols",[]);if(!Ln(r))throw new Error("cols is not an effective array");let e=await Yn(r,o);u+=e+"\n"})),t.writeFileSync(e,u,"utf8"),null}};return qn}));
//# sourceMappingURL=w-mesh-gms.umd.js.map
